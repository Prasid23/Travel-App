<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard | EasyTrip</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary-color: #2c3e50;
      --primary-dark: #1a252f;
      --primary-light: #34495e;
      --secondary-color: #e74c3c;
      --accent-color: #3498db;
      --success-color: #27ae60;
      --warning-color: #f39c12;
      --danger-color: #e74c3c;
      --text-color: #333;
      --text-light: #7f8c8d;
      --border-color: #ecf0f1;
      --bg-color: #f8f9fa;
      --card-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
    }

    .admin-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 250px;
      background-color: var(--primary-color);
      color: white;
      transition: var(--transition);
      position: fixed;
      height: 100vh;
      z-index: 100;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .sidebar-header h2 {
      font-size: 1.3rem;
      font-weight: 600;
      color: white;
    }

    .sidebar-menu {
      padding: 20px 0;
    }

    .menu-item {
      padding: 12px 20px;
      display: flex;
      align-items: center;
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .menu-item i {
      margin-right: 10px;
      font-size: 1.1rem;
      width: 24px;
      text-align: center;
    }

    .menu-item:hover {
      background-color: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .menu-item.active {
      background-color: var(--accent-color);
      color: white;
    }

    .menu-item.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 4px;
      background-color: white;
    }

    /* Main Content Styles */
    .main-content {
      flex: 1;
      margin-left: 250px;
      transition: var(--transition);
    }

    .top-navbar {
      background-color: white;
      padding: 15px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      position: sticky;
      top: 0;
      z-index: 90;
    }

    .search-bar {
      display: flex;
      align-items: center;
      background-color: var(--bg-color);
      border-radius: 30px;
      padding: 8px 15px;
      width: 300px;
    }

    .search-bar input {
      border: none;
      background: transparent;
      padding: 5px 10px;
      width: 100%;
      outline: none;
    }

    .search-bar i {
      color: var(--text-light);
    }

    .user-profile {
      display: flex;
      align-items: center;
    }

    .user-profile img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .user-role {
      font-size: 0.8rem;
      color: var(--text-light);
    }

    .logout-btn {
      margin-left: 20px;
      background-color: var(--danger-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 500;
      transition: var(--transition);
    }

    .logout-btn:hover {
      background-color: #c0392b;
    }

    /* Content Area */
    .content-area {
      padding: 25px;
    }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .page-title h1 {
      font-size: 1.8rem;
      color: var(--primary-color);
      font-weight: 600;
    }

    .page-title p {
      color: var(--text-light);
      font-size: 0.9rem;
    }

    .action-buttons .btn {
      padding: 10px 20px;
      border-radius: 5px;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      margin-left: 10px;
    }

    .btn-primary {
      background-color: var(--accent-color);
      color: white;
      border: none;
    }

    .btn-primary:hover {
      background-color: #2980b9;
    }

    .btn-secondary {
      background-color: white;
      color: var(--accent-color);
      border: 1px solid var(--accent-color);
    }

    .btn-secondary:hover {
      background-color: rgba(52, 152, 219, 0.1);
    }

    /* Stats Cards */
    .stats-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: var(--card-shadow);
      transition: var(--transition);
      animation: fadeInUp 0.5s ease-out;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .stat-card .stat-title {
      font-size: 0.9rem;
      color: var(--text-light);
      margin-bottom: 10px;
    }

    .stat-card .stat-value {
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .stat-card .stat-change {
      font-size: 0.8rem;
      display: flex;
      align-items: center;
    }

    .stat-change.positive {
      color: var(--success-color);
    }

    .stat-change.negative {
      color: var(--danger-color);
    }

    .stat-card .stat-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      position: absolute;
      right: 20px;
      top: 20px;
      opacity: 0.2;
    }

    /* Data Tables */
    .data-table {
      background-color: white;
      border-radius: 10px;
      box-shadow: var(--card-shadow);
      overflow: hidden;
      animation: fadeIn 0.5s ease-out;
    }

    .table-header {
      padding: 15px 20px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-title {
      font-weight: 600;
      color: var(--primary-color);
    }

    .table-actions {
      display: flex;
      gap: 10px;
    }

    .table-actions input {
      padding: 8px 15px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      outline: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 15px 20px;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    th {
      font-weight: 600;
      color: var(--primary-color);
      background-color: #f8f9fa;
    }

    tr:hover {
      background-color: #f8f9fa;
    }

    .status, .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }
      
    .status-active {
      background-color: rgba(46, 204, 113, 0.2);
      color: #2ecc71;
    }
      
    .status-inactive {
      background-color: rgba(231, 76, 60, 0.2);
      color: #e74c3c;
    }
      
    .status-pending {
      background-color: rgba(241, 196, 15, 0.2);
      color: #f1c40f;
    }
      
    .badge-accommodation {
      background-color: rgba(52, 152, 219, 0.2);
      color: #3498db;
    }
      
    .badge-bus {
      background-color: rgba(231, 76, 60, 0.2);
      color: #e74c3c;
    }

    .status-completed {
      background-color: rgba(52, 152, 219, 0.1);
      color: var(--accent-color);
    }

    .status-cancelled {
      background-color: rgba(149, 165, 166, 0.1);
      color: var(--text-light);
    }

    .action-btn {
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      margin-right: 5px;
    }

    .edit-btn {
      background-color: rgba(52, 152, 219, 0.1);
      color: var(--accent-color);
    }

    .edit-btn:hover {
      background-color: rgba(52, 152, 219, 0.2);
    }

    .delete-btn {
      background-color: rgba(231, 76, 60, 0.1);
      color: var(--danger-color);
    }

    .delete-btn:hover {
      background-color: rgba(231, 76, 60, 0.2);
    }

    .view-btn {
      background-color: rgba(39, 174, 96, 0.1);
      color: var(--success-color);
    }

    .view-btn:hover {
      background-color: rgba(39, 174, 96, 0.2);
    }

    /* Charts Section */
    .charts-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    .chart-card {
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: var(--card-shadow);
      animation: fadeInUp 0.5s ease-out;
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .chart-title {
      font-weight: 600;
      color: var(--primary-color);
    }

    .chart-period {
      font-size: 0.8rem;
      color: var(--text-light);
    }

    .chart-container {
      height: 250px;
      position: relative;
    }

    /* Settings Form */
    .settings-form {
      background-color: white;
      border-radius: 10px;
      padding: 25px;
      box-shadow: var(--card-shadow);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--primary-color);
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 10px 15px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      font-family: 'Poppins', sans-serif;
      transition: var(--transition);
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 30px;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeInUp {
      from { 
        opacity: 0;
        transform: translateY(20px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInLeft {
      from { 
        opacity: 0;
        transform: translateX(-20px);
      }
      to { 
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Responsive Styles */
    @media (max-width: 992px) {
      .sidebar {
        width: 70px;
        overflow: hidden;
      }

      .sidebar-header h2, .menu-item span {
        display: none;
      }

      .menu-item {
        justify-content: center;
        padding: 15px 0;
      }

      .menu-item i {
        margin-right: 0;
        font-size: 1.3rem;
      }

      .main-content {
        margin-left: 70px;
      }

      .charts-section {
        grid-template-columns: 1fr;
      }

      .form-row {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .search-bar {
        width: 200px;
      }

      .stats-cards {
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 576px) {
      .top-navbar {
        flex-direction: column;
        align-items: flex-start;
        padding: 15px;
      }

      .search-bar {
        width: 100%;
        margin-bottom: 15px;
      }

      .user-profile {
        width: 100%;
        justify-content: space-between;
      }

      .stats-cards {
        grid-template-columns: 1fr;
      }

      .page-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .action-buttons {
        margin-top: 15px;
        width: 100%;
        display: flex;
        justify-content: space-between;
      }

      .action-buttons .btn {
        margin-left: 0;
        width: 48%;
      }
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <h2>EasyTrip Admin</h2>
      </div>
      <div class="sidebar-menu">
        <a href="#" class="menu-item active" data-section="dashboard">
          <i class="fas fa-tachometer-alt"></i>
          <span>Dashboard</span>
        </a>
        <a href="#" class="menu-item" data-section="users">
          <i class="fas fa-users"></i>
          <span>Manage Users</span>
        </a>
        <a href="#" class="menu-item" data-section="revenue">
          <i class="fas fa-chart-line"></i>
          <span>Revenue Reports</span>
        </a>
        
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Top Navbar -->
      <div class="top-navbar">
        <div class="search-bar">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Search...">
        </div>
        <div class="user-profile">
          <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Admin User">
          <div class="user-info">
            <span class="user-name">Admin User</span>
            <span class="user-role">Super Admin</span>
          </div>
          <button class="logout-btn" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> Logout
          </button>
        </div>
      </div>

      <!-- Content Area -->
      <div class="content-area">
        <!-- Dashboard Section (Default Visible) -->
        <div class="content-section" id="dashboard-section">
          <div class="page-header">
            <div class="page-title">
              <h1>Dashboard Overview</h1>
              <p>Welcome back! Here's what's happening with your business today.</p>
            </div>
            <div class="action-buttons">
              <button class="btn btn-secondary">
                <i class="fas fa-download"></i> Export
              </button>
              <button class="btn btn-primary">
                <i class="fas fa-plus"></i> Add New
              </button>
            </div>
          </div>

          <!-- Stats Cards -->
          <div class="stats-cards">
            <div class="stat-card" id="total-revenue">
              <div class="stat-title">Total Revenue</div>
              <div class="stat-value">₹0</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i> From all bookings
              </div>
              <div class="stat-icon">
                <i class="fas fa-rupee-sign"></i>
              </div>
            </div>
            <div class="stat-card" id="total-users">
              <div class="stat-title">Total Users</div>
              <div class="stat-value">0</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i> All user types
              </div>
              <div class="stat-icon">
                <i class="fas fa-users"></i>
              </div>
            </div>
            <div class="stat-card" id="total-bookings">
              <div class="stat-title">Total Bookings</div>
              <div class="stat-value">0</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i> All booking types
              </div>
              <div class="stat-icon">
                <i class="fas fa-calendar-check"></i>
              </div>
            </div>
            <div class="stat-card" id="total-listings">
              <div class="stat-title">Total Listings</div>
              <div class="stat-value">0</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i> All property types
              </div>
              <div class="stat-icon">
                <i class="fas fa-home"></i>
              </div>
            </div>
          </div>

          <!-- Charts Section -->
          <div class="charts-section">
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Revenue Overview</div>
                <div class="chart-period">Last 30 Days</div>
              </div>
              <div class="chart-container">
                <canvas id="revenueChart" width="600" height="250"></canvas>
              </div>
            </div>
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">User Acquisition</div>
                <div class="chart-period">Last 30 Days</div>
              </div>
              <div class="chart-container">
                <canvas id="usersChart" width="600" height="250"></canvas>
              </div>
            </div>
          </div>

          <!-- Recent Users Table -->
          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Recent Users</div>
              <div class="table-actions">
                <input type="text" placeholder="Filter users...">
              </div>
            </div>
            <table id="recent-users-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Joined</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>#1001</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/women/43.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Sarah Johnson
                    </div>
                  </td>
                  <td>sarah@example.com</td>
                  <td>2023-05-15</td>
                  <td><span class="status status-active">Active</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#1002</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Michael Brown
                    </div>
                  </td>
                  <td>michael@example.com</td>
                  <td>2023-05-10</td>
                  <td><span class="status status-active">Active</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#1003</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/women/65.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Emily Davis
                    </div>
                  </td>
                  <td>emily@example.com</td>
                  <td>2023-05-05</td>
                  <td><span class="status status-inactive">Inactive</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#1004</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/men/75.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Robert Wilson
                    </div>
                  </td>
                  <td>robert@example.com</td>
                  <td>2023-05-01</td>
                  <td><span class="status status-pending">Pending</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#1005</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/women/33.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Jennifer Lee
                    </div>
                  </td>
                  <td>jennifer@example.com</td>
                  <td>2023-04-28</td>
                  <td><span class="status status-active">Active</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <!-- Recent Bookings Table -->
          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Recent Bookings</div>
              <div class="table-actions">
                <input type="text" placeholder="Filter bookings...">
              </div>
            </div>
            <table id="recent-bookings-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>User</th>
                  <th>Property</th>
                  <th>Check-in</th>
                  <th>Check-out</th>
                  <th>Amount</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="8" class="text-center"><i class="fas fa-spinner fa-spin"></i> Loading bookings...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Users Section (Hidden by default) -->
        <div class="content-section" id="users-section" style="display: none;">
          <div class="page-header">
            <div class="page-title">
              <h1>User Management</h1>
              <p>Manage all registered users and their permissions</p>
            </div>
            <div class="action-buttons">
              <button class="btn btn-secondary">
                <i class="fas fa-filter"></i> Filter
              </button>
              <button class="btn btn-primary">
                <i class="fas fa-user-plus"></i> Add User
              </button>
            </div>
          </div>

          <div class="data-table">
            <div class="table-header">
              <div class="table-title">All Users</div>
              <div class="table-actions">
                <input type="text" placeholder="Search users...">
                <select>
                  <option>All Status</option>
                  <option>Active</option>
                  <option>Inactive</option>
                  <option>Pending</option>
                </select>
              </div>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Role</th>
                  <th>Last Login</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>#1001</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/women/43.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Sarah Johnson
                    </div>
                  </td>
                  <td>sarah@example.com</td>
                  <td>Customer</td>
                  <td>2023-06-10 14:30</td>
                  <td><span class="status status-active">Active</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#1002</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Michael Brown
                    </div>
                  </td>
                  <td>michael@example.com</td>
                  <td>Admin</td>
                  <td>2023-06-10 10:15</td>
                  <td><span class="status status-active">Active</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#1003</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/women/65.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Emily Davis
                    </div>
                  </td>
                  <td>emily@example.com</td>
                  <td>Customer</td>
                  <td>2023-06-08 16:45</td>
                  <td><span class="status status-inactive">Inactive</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#1004</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/men/75.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Robert Wilson
                    </div>
                  </td>
                  <td>robert@example.com</td>
                  <td>Customer</td>
                  <td>2023-06-05 09:20</td>
                  <td><span class="status status-pending">Pending</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#1005</td>
                  <td>
                    <div style="display: flex; align-items: center;">
                      <img src="https://randomuser.me/api/portraits/women/33.jpg" alt="User" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; object-fit: cover;">
                      Jennifer Lee
                    </div>
                  </td>
                  <td>jennifer@example.com</td>
                  <td>Customer</td>
                  <td>2023-06-04 11:30</td>
                  <td><span class="status status-active">Active</span></td>
                  <td>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn">
                      <i class="fas fa-trash"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Revenue Reports Section (Hidden by default) -->
        <div class="content-section" id="revenue-section" style="display: none;">
          <div class="page-header">
            <div class="page-title">
              <h1>Revenue Reports</h1>
              <p>Analyze your business performance and revenue streams</p>
            </div>
            <div class="action-buttons">
              <button class="btn btn-secondary">
                <i class="fas fa-download"></i> Export
              </button>
              <select style="padding: 10px; border-radius: 5px; border: 1px solid var(--border-color);">
                <option>Last 7 Days</option>
                <option selected>Last 30 Days</option>
                <option>Last 90 Days</option>
                <option>This Year</option>
              </select>
            </div>
          </div>

          <!-- Summary Cards -->
          <div class="summary-cards">
            <div class="summary-card">
              <div class="card-icon"><i class="fas fa-money-bill-wave"></i></div>
              <div class="card-content">
                <h3>Total Revenue</h3>
                <p class="value">₹148,120</p>
              </div>
            </div>
            <div class="summary-card">
              <div class="card-icon"><i class="fas fa-chart-line"></i></div>
              <div class="card-content">
                <h3>Avg. Monthly</h3>
                <p class="value">₹12,343</p>
              </div>
            </div>
            <div class="summary-card">
              <div class="card-icon"><i class="fas fa-calendar-check"></i></div>
              <div class="card-content">
                <h3>Best Month</h3>
                <p class="value">May (₹42,500)</p>
              </div>
            </div>
          </div>

          <!-- Charts Section -->
          <div class="charts-section">
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Revenue by Source</div>
                <div class="chart-period">Last 30 Days</div>
              </div>
              <div class="chart-container">
                <canvas id="revenueBySourceChart" width="600" height="250"></canvas>
              </div>
            </div>
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Revenue Growth</div>
                <div class="chart-period">Last 12 Months</div>
              </div>
              <div class="chart-container">
                <canvas id="revenueGrowthChart" width="600" height="250"></canvas>
              </div>
            </div>
          </div>

          <!-- Top Properties Table -->
          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Top Properties by Revenue</div>
              <div class="table-actions">
                <input type="text" placeholder="Search properties...">
              </div>
            </div>
            <table id="top-properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Bookings</th>
                  <th>Revenue</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Luxury Villa Goa</td>
                  <td><span class="badge badge-accommodation">Accommodation</span></td>
                  <td>25</td>
                  <td>₹42,500</td>
                </tr>
                <tr>
                  <td>Delhi to Mumbai Express</td>
                  <td><span class="badge badge-bus">Bus</span></td>
                  <td>38</td>
                  <td>₹38,000</td>
                </tr>
                <tr>
                  <td>Mountain Resort Shimla</td>
                  <td><span class="badge badge-accommodation">Accommodation</span></td>
                  <td>18</td>
                  <td>₹36,000</td>
                </tr>
                <tr>
                  <td>Bangalore to Chennai Deluxe</td>
                  <td><span class="badge badge-bus">Bus</span></td>
                  <td>32</td>
                  <td>₹32,000</td>
                </tr>
                <tr>
                  <td>Asian Explorer</td>
                  <td>12</td>
                  <td>$6,000</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Bookings Section (Hidden by default) -->
        <div class="content-section" id="bookings-section" style="display: none;">
          <div class="page-header">
            <div class="page-title">
              <h1>Booking Management</h1>
              <p>View and manage all customer bookings</p>
            </div>
            <div class="action-buttons">
              <button class="btn btn-secondary">
                <i class="fas fa-filter"></i> Filter
              </button>
              <button class="btn btn-primary">
                <i class="fas fa-plus"></i> Add Booking
              </button>
            </div>
          </div>

          <div class="data-table">
            <div class="table-header">
              <div class="table-title">All Bookings</div>
              <div class="table-actions">
                <input type="text" placeholder="Search bookings...">
                <select>
                  <option>All Status</option>
                  <option>Confirmed</option>
                  <option>Pending</option>
                  <option>Cancelled</option>
                  <option>Completed</option>
                </select>
              </div>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Booking ID</th>
                  <th>Customer</th>
                  <th>Trip</th>
                  <th>Date</th>
                  <th>Guests</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>#BK1001</td>
                  <td>Sarah Johnson</td>
                  <td>Paris Weekend Getaway</td>
                  <td>2023-07-15</td>
                  <td>2</td>
                  <td>$1,250.00</td>
                  <td><span class="status status-completed">Confirmed</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#BK1002</td>
                  <td>Michael Brown</td>
                  <td>Italian Adventure</td>
                  <td>2023-08-20</td>
                  <td>4</td>
                  <td>$3,450.00</td>
                  <td><span class="status status-completed">Confirmed</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#BK1003</td>
                  <td>Emily Davis</td>
                  <td>Beach Paradise</td>
                  <td>2023-06-25</td>
                  <td>2</td>
                  <td>$1,800.00</td>
                  <td><span class="status status-pending">Pending</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#BK1004</td>
                  <td>Robert Wilson</td>
                  <td>Mountain Retreat</td>
                  <td>2023-09-10</td>
                  <td>1</td>
                  <td>$950.00</td>
                  <td><span class="status status-completed">Confirmed</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#BK1005</td>
                  <td>Jennifer Lee</td>
                  <td>Asian Explorer</td>
                  <td>2023-11-05</td>
                  <td>3</td>
                  <td>$4,200.00</td>
                  <td><span class="status status-cancelled">Cancelled</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="action-btn edit-btn">
                      <i class="fas fa-edit"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Transactions Section (Hidden by default) -->
        <div class="content-section" id="transactions-section" style="display: none;">
          <div class="page-header">
            <div class="page-title">
              <h1>Transaction History</h1>
              <p>View all payment transactions processed through the system</p>
            </div>
            <div class="action-buttons">
              <button class="btn btn-secondary">
                <i class="fas fa-download"></i> Export
              </button>
              <select style="padding: 10px; border-radius: 5px; border: 1px solid var(--border-color);">
                <option>All Transactions</option>
                <option>Completed</option>
                <option>Pending</option>
                <option>Failed</option>
                <option>Refunded</option>
              </select>
            </div>
          </div>

          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Transaction Records</div>
              <div class="table-actions">
                <input type="text" placeholder="Search transactions...">
              </div>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Transaction ID</th>
                  <th>Booking ID</th>
                  <th>Customer</th>
                  <th>Date</th>
                  <th>Amount</th>
                  <th>Payment Method</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>#TXN1001</td>
                  <td>#BK1001</td>
                  <td>Sarah Johnson</td>
                  <td>2023-06-10 14:30</td>
                  <td>$1,250.00</td>
                  <td>Credit Card</td>
                  <td><span class="status status-completed">Completed</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#TXN1002</td>
                  <td>#BK1002</td>
                  <td>Michael Brown</td>
                  <td>2023-06-09 11:15</td>
                  <td>$3,450.00</td>
                  <td>PayPal</td>
                  <td><span class="status status-completed">Completed</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#TXN1003</td>
                  <td>#BK1003</td>
                  <td>Emily Davis</td>
                  <td>2023-06-08 16:45</td>
                  <td>$1,800.00</td>
                  <td>Credit Card</td>
                  <td><span class="status status-pending">Pending</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#TXN1004</td>
                  <td>#BK1004</td>
                  <td>Robert Wilson</td>
                  <td>2023-06-07 09:20</td>
                  <td>$950.00</td>
                  <td>Bank Transfer</td>
                  <td><span class="status status-completed">Completed</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>#TXN1005</td>
                  <td>#BK1005</td>
                  <td>Jennifer Lee</td>
                  <td>2023-06-06 13:10</td>
                  <td>$4,200.00</td>
                  <td>Credit Card</td>
                  <td><span class="status status-cancelled">Refunded</span></td>
                  <td>
                    <button class="action-btn view-btn">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Settings Section (Hidden by default) -->
        <div class="content-section" id="settings-section" style="display: none;">
          <div class="page-header">
            <div class="page-title">
              <h1>System Settings</h1>
              <p>Configure your application settings and preferences</p>
            </div>
          </div>

          <div class="settings-form">
            <form>
              <div class="form-row">
                <div class="form-group">
                  <label for="site-name">Site Name</label>
                  <input type="text" id="site-name" value="EasyTrip">
                </div>
                <div class="form-group">
                  <label for="site-url">Site URL</label>
                  <input type="text" id="site-url" value="https://www.easytrip.com">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="admin-email">Admin Email</label>
                  <input type="email" id="admin-email" value="admin@easytrip.com">
                </div>
                <div class="form-group">
                  <label for="timezone">Timezone</label>
                  <select id="timezone">
                    <option>(UTC-12:00) International Date Line West</option>
                    <option>(UTC-08:00) Pacific Time (US & Canada)</option>
                    <option selected>(UTC-05:00) Eastern Time (US & Canada)</option>
                    <option>(UTC+00:00) Greenwich Mean Time</option>
                    <option>(UTC+01:00) Central European Time</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="site-description">Site Description</label>
                <textarea id="site-description" rows="3">Your ultimate travel booking platform for amazing experiences worldwide.</textarea>
              </div>

              <div class="form-group">
                <label for="maintenance-mode">Maintenance Mode</label>
                <select id="maintenance-mode">
                  <option value="0">Disabled</option>
                  <option value="1">Enabled</option>
                </select>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-secondary">
                  Cancel
                </button>
                <button type="submit" class="btn btn-primary">
                  Save Changes
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Check if admin is logged in
    document.addEventListener('DOMContentLoaded', function() {
      // For demo purposes, set a default admin token if not present
      if (!localStorage.getItem('adminToken')) {
        localStorage.setItem('adminToken', 'admin-token-' + Date.now());
        localStorage.setItem('adminData', JSON.stringify({
          id: 1,
          username: 'admin',
          name: 'System Administrator',
          email: 'admin@easytrip.com',
          role: 'admin'
        }));
      }
      
      const adminToken = localStorage.getItem('adminToken');
      const adminData = JSON.parse(localStorage.getItem('adminData') || '{}');
      
      // Set admin name in the UI
      const adminNameElement = document.getElementById('adminName');
      if (adminNameElement && adminData.name) {
        adminNameElement.textContent = adminData.name;
      }
      
      // Load dashboard data
      loadDashboardData();
      
      // Initialize event listeners
      initializeEventListeners();
      
      // Debug: Log to console
      console.log('Dashboard initialized, loading data...');
    });
    
    // Function to initialize event listeners
    function initializeEventListeners() {
      // Menu item clicks
      document.querySelectorAll('.menu-item').forEach(item => {
        item.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Remove active class from all menu items
          document.querySelectorAll('.menu-item').forEach(i => {
            i.classList.remove('active');
          });
          
          // Add active class to clicked menu item
          this.classList.add('active');
          
          // Get the section to show
          const section = this.getAttribute('data-section');
          
          // Hide all content sections
          document.querySelectorAll('.content-section').forEach(sec => {
            sec.style.display = 'none';
          });
          
          // Show the selected section
          document.getElementById(`${section}-section`).style.display = 'block';
          
          // Load section data if needed
          if (section === 'dashboard') {
            loadDashboardData();
          } else if (section === 'users') {
            loadUsersData();
          } else if (section === 'bookings') {
            loadBookingsData();
          } else if (section === 'revenue') {
            loadRevenueData();
          } else if (section === 'transactions') {
            loadTransactionsData();
          }
        });
      });
    }
    
    // Function to handle logout
    function logout() {
      // Clear admin data from local storage
      localStorage.removeItem('adminToken');
      localStorage.removeItem('adminData');
      
      // Show logout message
      const adminContainer = document.querySelector('.admin-container');
      adminContainer.innerHTML = `
        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; flex-direction: column;">
          <div style="text-align: center; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);">
            <i class="fas fa-check-circle" style="font-size: 48px; color: var(--success-color); margin-bottom: 20px;"></i>
            <h2>Logged Out Successfully</h2>
            <p style="margin-bottom: 20px;">You have been logged out of the admin dashboard.</p>
            <a href="admin-login.html" class="btn btn-primary">Back to Login</a>
          </div>
        </div>
      `;
      
      // Redirect to login page after a delay
      setTimeout(() => {
        window.location.href = 'admin-login.html';
      }, 2000);
    }

    // Function to load dashboard data
    function loadDashboardData() {
      console.log('Loading dashboard data...');
      
      // Directly set default values for immediate visual feedback
      const defaultStats = {
        totalUsers: 4,
        totalBookings: 16,
        totalRevenue: 148120,
        totalListings: 13
      };
      updateDashboardStats(defaultStats);
      
      // Clear tables
      const recentUsersTable = document.querySelector('#recent-users-table tbody');
      if (recentUsersTable) {
        recentUsersTable.innerHTML = '<tr><td colspan="6" class="text-center"><i class="fas fa-spinner fa-spin"></i> Loading...</td></tr>';
      }
      
      const recentBookingsTable = document.querySelector('#recent-bookings-table tbody');
      if (recentBookingsTable) {
        recentBookingsTable.innerHTML = '<tr><td colspan="8" class="text-center"><i class="fas fa-spinner fa-spin"></i> Loading...</td></tr>';
      }
      
      // Fetch dashboard stats from API
      fetch('../php/api_admin.php?action=getDashboardStats')
        .then(response => {
          console.log('Dashboard API response:', response);
          if (!response.ok) {
            throw new Error(`HTTP error ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          console.log('Dashboard data received:', data);
          if (data.success) {
            // Update stats cards
            updateDashboardStats(data.stats);
            
            // Update recent users table
            if (data.recentUsers && data.recentUsers.length > 0) {
              updateRecentUsers(data.recentUsers);
            }
            
            // Update recent bookings table
            if (data.recentBookings && data.recentBookings.length > 0) {
              updateRecentBookings(data.recentBookings);
            }
          } else {
            throw new Error(data.message || 'Failed to load dashboard data');
          }
        })
        .catch(error => {
          console.error('Error loading dashboard data:', error);
          showErrorMessage('dashboard-section', error.message);
          
          // Show error in tables
          if (recentUsersTable) {
            recentUsersTable.innerHTML = '<tr><td colspan="6" class="text-center"><i class="fas fa-exclamation-circle"></i> Could not load recent users</td></tr>';
          }
          
          if (recentBookingsTable) {
            recentBookingsTable.innerHTML = '<tr><td colspan="8" class="text-center"><i class="fas fa-exclamation-circle"></i> Could not load recent bookings</td></tr>';
          }
        });
    }
    
    // Function to update dashboard stats
    function updateDashboardStats(stats) {
      console.log('Updating dashboard stats with:', stats);
      
      // Format numbers with commas
      const formatNumber = (num) => {
        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      };
      
      // Update total users
      const totalUsersElement = document.querySelector('#total-users .stat-value');
      if (totalUsersElement) {
        totalUsersElement.textContent = formatNumber(stats.totalUsers || 0);
        console.log('Updated total users:', totalUsersElement.textContent);
      } else {
        console.error('Could not find total users element');
      }
      
      // Update total bookings
      const totalBookingsElement = document.querySelector('#total-bookings .stat-value');
      if (totalBookingsElement) {
        totalBookingsElement.textContent = formatNumber(stats.totalBookings || 0);
        console.log('Updated total bookings:', totalBookingsElement.textContent);
      } else {
        console.error('Could not find total bookings element');
      }
      
      // Update total revenue
      const totalRevenueElement = document.querySelector('#total-revenue .stat-value');
      if (totalRevenueElement) {
        totalRevenueElement.textContent = `₹${formatNumber(stats.totalRevenue || 0)}`;
        console.log('Updated total revenue:', totalRevenueElement.textContent);
      } else {
        console.error('Could not find total revenue element');
      }
      
      // Update total listings
      const totalListingsElement = document.querySelector('#total-listings .stat-value');
      if (totalListingsElement) {
        totalListingsElement.textContent = formatNumber(stats.totalListings || 0);
        console.log('Updated total listings:', totalListingsElement.textContent);
      } else {
        console.error('Could not find total listings element');
      }
    }
    
    // Function to update recent users table
    function updateRecentUsers(users) {
      const tbody = document.querySelector('#recent-users-table tbody');
      if (!tbody) return;
      
      if (users.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" class="text-center">No users found</td></tr>';
        return;
      }
      
      let html = '';
      users.forEach(user => {
        const date = new Date(user.created_at).toLocaleDateString();
        html += `
          <tr>
            <td>#${user.user_id}</td>
            <td>
              <div style="display: flex; align-items: center;">
                <div class="avatar-circle" style="background-color: var(--accent-color);">
                  ${user.username.charAt(0).toUpperCase()}
                </div>
                <div style="margin-left: 10px;">
                  <div style="font-weight: 500;">${user.username}</div>
                  <div style="font-size: 0.8rem; color: var(--text-light);">${user.email}</div>
                </div>
              </div>
            </td>
            <td>${date}</td>
            <td>
              <button class="action-btn view-btn" data-id="${user.user_id}" onclick="viewUser(${user.user_id})">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn edit-btn" data-id="${user.user_id}" onclick="editUser(${user.user_id})">
                <i class="fas fa-edit"></i>
              </button>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }
    
    // Function to update recent bookings table
    function updateRecentBookings(bookings) {
      const tbody = document.querySelector('#recent-bookings-table tbody');
      if (!tbody) return;
      
      if (bookings.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="text-center">No bookings found</td></tr>';
        return;
      }
      
      let html = '';
      bookings.forEach(booking => {
        const checkIn = new Date(booking.check_in_date).toLocaleDateString();
        const statusClass = booking.booking_status === 'confirmed' ? 'status-completed' : 
                           booking.booking_status === 'pending' ? 'status-pending' : 'status-cancelled';
        
        html += `
          <tr>
            <td>#BK${booking.booking_id}</td>
            <td>${booking.username}</td>
            <td>${booking.property_name}</td>
            <td>${checkIn}</td>
            <td>₹${parseFloat(booking.total_amount).toLocaleString()}</td>
            <td><span class="status ${statusClass}">${booking.booking_status}</span></td>
            <td>
              <button class="action-btn view-btn" data-id="${booking.booking_id}" onclick="viewBooking(${booking.booking_id})">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn edit-btn" data-id="${booking.booking_id}" onclick="editBooking(${booking.booking_id})">
                <i class="fas fa-edit"></i>
              </button>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }
    
    // Function to show error message
    function showErrorMessage(sectionId, message) {
      const section = document.getElementById(sectionId);
      if (!section) return;
      
      const errorHtml = `
        <div class="error-message" style="text-align: center; padding: 20px; margin: 20px 0;">
          <i class="fas fa-exclamation-circle" style="font-size: 48px; color: var(--danger-color); margin-bottom: 20px;"></i>
          <h3>Error Loading Data</h3>
          <p>${message}</p>
          <button class="btn btn-primary" onclick="loadDashboardData()">Try Again</button>
        </div>
      `;
      
      // Insert error message after the stats cards
      const statsCards = section.querySelector('.stats-cards');
      if (statsCards) {
        statsCards.insertAdjacentHTML('afterend', errorHtml);
      } else {
        section.innerHTML = errorHtml;
      }
    }
    
    // Function to load users data
    function loadUsersData() {
      // Show loading indicator
      document.querySelector('#users-section .data-table tbody').innerHTML = 
        '<tr><td colspan="5" class="text-center"><i class="fas fa-spinner fa-spin"></i> Loading users...</td></tr>';
      
      // Fetch users from API
      fetch('../php/api_admin.php?action=getUsers')
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          if (data.success) {
            updateUsersTable(data.users);
          } else {
            throw new Error(data.message || 'Failed to load users');
          }
        })
        .catch(error => {
          console.error('Error loading users:', error);
          document.querySelector('#users-section .data-table tbody').innerHTML = 
            `<tr><td colspan="5" class="text-center"><i class="fas fa-exclamation-circle"></i> ${error.message}</td></tr>`;
        });
    }
    
    // Function to update users table
    function updateUsersTable(users) {
      const tbody = document.querySelector('#users-section .data-table tbody');
      if (!tbody) return;
      
      if (users.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" class="text-center">No users found</td></tr>';
        return;
      }
      
      let html = '';
      users.forEach(user => {
        const date = new Date(user.created_at).toLocaleDateString();
        html += `
          <tr>
            <td>#${user.user_id}</td>
            <td>
              <div style="display: flex; align-items: center;">
                <div class="avatar-circle" style="background-color: var(--accent-color);">
                  ${user.username.charAt(0).toUpperCase()}
                </div>
                <div style="margin-left: 10px;">
                  <div style="font-weight: 500;">${user.username}</div>
                  <div style="font-size: 0.8rem; color: var(--text-light);">${user.email}</div>
                </div>
              </div>
            </td>
            <td>${date}</td>
            <td>
              <button class="action-btn view-btn" data-id="${user.user_id}" onclick="viewUser(${user.user_id})">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn edit-btn" data-id="${user.user_id}" onclick="editUser(${user.user_id})">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn delete-btn" data-id="${user.user_id}" onclick="deleteUser(${user.user_id})">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }
    
    // Function to handle viewing a user
    function viewUser(userId) {
      alert(`View user details for ID: ${userId}`);
      // In a real implementation, this would fetch user details and show them in a modal
    }
    
    // Function to handle editing a user
    function editUser(userId) {
      alert(`Edit user with ID: ${userId}`);
      // In a real implementation, this would open a form to edit the user
    }
    
    // Function to handle deleting a user
    function deleteUser(userId) {
      if (confirm(`Are you sure you want to delete user #${userId}? This action cannot be undone.`)) {
        // Send delete request to API
        const formData = new FormData();
        formData.append('userId', userId);
        formData.append('action', 'deleteUser');
        
        fetch('../php/api_admin.php', {
          method: 'POST',
          body: formData
        })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              alert('User deleted successfully');
              loadUsersData(); // Reload users list
            } else {
              alert(`Error: ${data.message}`);
            }
          })
          .catch(error => {
            alert(`Error: ${error.message}`);
          });
      }
    }
    
    // Function to load bookings data
    function loadBookingsData() {
      // Show loading indicator
      document.querySelector('#bookings-section .data-table tbody').innerHTML = 
        '<tr><td colspan="8" class="text-center"><i class="fas fa-spinner fa-spin"></i> Loading bookings...</td></tr>';
      
      // Fetch bookings from API
      fetch('../php/api_admin.php?action=getBookings')
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          if (data.success) {
            updateBookingsTable(data.bookings);
          } else {
            throw new Error(data.message || 'Failed to load bookings');
          }
        })
        .catch(error => {
          console.error('Error loading bookings:', error);
          document.querySelector('#bookings-section .data-table tbody').innerHTML = 
            `<tr><td colspan="8" class="text-center"><i class="fas fa-exclamation-circle"></i> ${error.message}</td></tr>`;
        });
    }
    
    // Function to update bookings table
    function updateBookingsTable(bookings) {
      const tbody = document.querySelector('#bookings-section .data-table tbody');
      if (!tbody) return;
      
      if (bookings.length === 0) {
        tbody.innerHTML = '<tr><td colspan="8" class="text-center">No bookings found</td></tr>';
        return;
      }
      
      let html = '';
      bookings.forEach(booking => {
        const checkIn = new Date(booking.check_in_date).toLocaleDateString();
        const checkOut = new Date(booking.check_out_date).toLocaleDateString();
        const statusClass = booking.booking_status === 'confirmed' ? 'status-completed' : 
                           booking.booking_status === 'pending' ? 'status-pending' : 'status-cancelled';
        
        html += `
          <tr>
            <td>#BK${booking.booking_id}</td>
            <td>${booking.username}</td>
            <td>${booking.property_name}</td>
            <td>${checkIn} - ${checkOut}</td>
            <td>${booking.number_of_guests}</td>
            <td>₹${parseFloat(booking.total_amount).toLocaleString()}</td>
            <td><span class="status ${statusClass}">${booking.booking_status}</span></td>
            <td>
              <button class="action-btn view-btn" data-id="${booking.booking_id}" onclick="viewBooking(${booking.booking_id})">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn edit-btn" data-id="${booking.booking_id}" onclick="editBooking(${booking.booking_id})">
                <i class="fas fa-edit"></i>
              </button>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }
    
    // Function to handle viewing a booking
    function viewBooking(bookingId) {
      // Fetch booking details from API
      fetch(`../php/api_admin.php?action=getBookingDetails&bookingId=${bookingId}`)
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            showBookingDetails(data.booking, data.transaction);
          } else {
            alert(`Error: ${data.message}`);
          }
        })
        .catch(error => {
          alert(`Error: ${error.message}`);
        });
    }
    
    // Function to show booking details in a modal
    function showBookingDetails(booking, transaction) {
      // Create modal HTML
      const modalHtml = `
        <div class="modal-overlay" id="bookingDetailsModal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Booking #BK${booking.booking_id}</h2>
              <button class="modal-close" onclick="closeModal('bookingDetailsModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
              <div class="booking-details">
                <div class="detail-row">
                  <div class="detail-label">Property:</div>
                  <div class="detail-value">${booking.property_name}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Location:</div>
                  <div class="detail-value">${booking.property_location}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Guest:</div>
                  <div class="detail-value">${booking.username} (${booking.email})</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Check-in:</div>
                  <div class="detail-value">${new Date(booking.check_in_date).toLocaleDateString()}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Check-out:</div>
                  <div class="detail-value">${new Date(booking.check_out_date).toLocaleDateString()}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Guests:</div>
                  <div class="detail-value">${booking.number_of_guests}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Room Type:</div>
                  <div class="detail-value">${booking.room_type}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Nightly Rate:</div>
                  <div class="detail-value">₹${parseFloat(booking.nightly_rate).toLocaleString()}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Total Amount:</div>
                  <div class="detail-value">₹${parseFloat(booking.total_amount).toLocaleString()}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Status:</div>
                  <div class="detail-value">
                    <span class="status ${booking.booking_status === 'confirmed' ? 'status-completed' : 
                                          booking.booking_status === 'pending' ? 'status-pending' : 'status-cancelled'}">
                      ${booking.booking_status}
                    </span>
                  </div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">Booking Date:</div>
                  <div class="detail-value">${new Date(booking.created_at).toLocaleString()}</div>
                </div>
                ${booking.special_requests ? `
                <div class="detail-row">
                  <div class="detail-label">Special Requests:</div>
                  <div class="detail-value">${booking.special_requests}</div>
                </div>` : ''}
                ${transaction ? `
                <div class="detail-section">
                  <h3>Payment Information</h3>
                  <div class="detail-row">
                    <div class="detail-label">Transaction ID:</div>
                    <div class="detail-value">#TXN${transaction.transaction_id}</div>
                  </div>
                  <div class="detail-row">
                    <div class="detail-label">Amount:</div>
                    <div class="detail-value">₹${parseFloat(transaction.amount).toLocaleString()}</div>
                  </div>
                  <div class="detail-row">
                    <div class="detail-label">Status:</div>
                    <div class="detail-value">
                      <span class="status ${transaction.status === 'completed' ? 'status-completed' : 
                                            transaction.status === 'pending' ? 'status-pending' : 'status-cancelled'}">
                        ${transaction.status}
                      </span>
                    </div>
                  </div>
                  <div class="detail-row">
                    <div class="detail-label">Date:</div>
                    <div class="detail-value">${new Date(transaction.created_at).toLocaleString()}</div>
                  </div>
                </div>` : ''}
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" onclick="closeModal('bookingDetailsModal')">Close</button>
              <button class="btn btn-primary" onclick="editBooking(${booking.booking_id})">Edit Booking</button>
            </div>
          </div>
        </div>
      `;
      
      // Add modal to the page
      document.body.insertAdjacentHTML('beforeend', modalHtml);
      
      // Add styles for the modal if not already present
      if (!document.getElementById('modalStyles')) {
        const modalStyles = `
          <style id="modalStyles">
            .modal-overlay {
              position: fixed;
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;
              background-color: rgba(0, 0, 0, 0.5);
              display: flex;
              justify-content: center;
              align-items: center;
              z-index: 1000;
            }
            .modal-content {
              background-color: white;
              border-radius: 10px;
              width: 90%;
              max-width: 600px;
              max-height: 90vh;
              overflow-y: auto;
              box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
            }
            .modal-header {
              padding: 20px;
              border-bottom: 1px solid var(--border-color);
              display: flex;
              justify-content: space-between;
              align-items: center;
            }
            .modal-header h2 {
              margin: 0;
              font-size: 1.5rem;
            }
            .modal-close {
              background: none;
              border: none;
              font-size: 1.2rem;
              cursor: pointer;
              color: var(--text-light);
            }
            .modal-body {
              padding: 20px;
            }
            .modal-footer {
              padding: 20px;
              border-top: 1px solid var(--border-color);
              display: flex;
              justify-content: flex-end;
              gap: 10px;
            }
            .booking-details {
              display: flex;
              flex-direction: column;
              gap: 15px;
            }
            .detail-row {
              display: flex;
              border-bottom: 1px solid var(--border-color);
              padding-bottom: 10px;
            }
            .detail-label {
              font-weight: 600;
              width: 150px;
              color: var(--text-light);
            }
            .detail-value {
              flex: 1;
            }
            .detail-section {
              margin-top: 20px;
              padding-top: 20px;
              border-top: 1px solid var(--border-color);
            }
            .detail-section h3 {
              margin-bottom: 15px;
              color: var(--primary-color);
            }
          </style>
        `;
        document.head.insertAdjacentHTML('beforeend', modalStyles);
      }
    }
    
    // Function to close a modal
    function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.remove();
      }
    }
    
    // Function to handle editing a booking
    function editBooking(bookingId) {
      // Fetch booking details if not already loaded
      fetch(`../php/api_admin.php?action=getBookingDetails&bookingId=${bookingId}`)
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            showBookingEditForm(data.booking);
          } else {
            alert(`Error: ${data.message}`);
          }
        })
        .catch(error => {
          alert(`Error: ${error.message}`);
        });
    }
    
    // Function to show booking edit form
    function showBookingEditForm(booking) {
      // Create modal HTML for editing
      const modalHtml = `
        <div class="modal-overlay" id="editBookingModal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Edit Booking #BK${booking.booking_id}</h2>
              <button class="modal-close" onclick="closeModal('editBookingModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
              <form id="editBookingForm">
                <input type="hidden" id="bookingId" value="${booking.booking_id}">
                <div class="form-group">
                  <label for="bookingStatus">Booking Status</label>
                  <select id="bookingStatus" class="form-control">
                    <option value="pending" ${booking.booking_status === 'pending' ? 'selected' : ''}>Pending</option>
                    <option value="confirmed" ${booking.booking_status === 'confirmed' ? 'selected' : ''}>Confirmed</option>
                    <option value="cancelled" ${booking.booking_status === 'cancelled' ? 'selected' : ''}>Cancelled</option>
                  </select>
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" onclick="closeModal('editBookingModal')">Cancel</button>
              <button class="btn btn-primary" onclick="updateBookingStatus()">Save Changes</button>
            </div>
          </div>
        </div>
      `;
      
      // Add modal to the page
      document.body.insertAdjacentHTML('beforeend', modalHtml);
    }
    
    // Function to update booking status
    function updateBookingStatus() {
      const bookingId = document.getElementById('bookingId').value;
      const status = document.getElementById('bookingStatus').value;
      
      // Create form data
      const formData = new FormData();
      formData.append('bookingId', bookingId);
      formData.append('status', status);
      formData.append('action', 'updateBooking');
      
      // Send update request
      fetch('../php/api_admin.php', {
        method: 'POST',
        body: formData
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            alert('Booking updated successfully');
            closeModal('editBookingModal');
            loadBookingsData(); // Reload bookings list
          } else {
            alert(`Error: ${data.message}`);
          }
        })
        .catch(error => {
          alert(`Error: ${error.message}`);
        });
    }
    
    // Function to load revenue data
    function loadRevenueData() {
      console.log('Loading revenue data...');
      
      // Show loading indicators
      document.querySelectorAll('#revenue-section .chart-container').forEach(container => {
        container.innerHTML = '<div class="loading-container"><i class="fas fa-spinner fa-spin"></i> Loading chart data...</div>';
      });
      
      // Use demo data for immediate display
      const demoMonthlyRevenue = [
        { month: 'Jan', revenue: 12000 },
        { month: 'Feb', revenue: 15000 },
        { month: 'Mar', revenue: 18000 },
        { month: 'Apr', revenue: 22000 },
        { month: 'May', revenue: 42500 },
        { month: 'Jun', revenue: 38600 }
      ];
      
      const demoPropertyRevenue = [
        { type: 'Luxury Villa', bookings: 25, revenue: 42500 },
        { type: 'Bus', bookings: 70, revenue: 70000 },
        { type: 'Resort', bookings: 18, revenue: 36000 }
      ];
      
      const demoTopProperties = [
        { property: 'Luxury Villa Goa', type: 'accommodation', bookings: 25, revenue: 42500 },
        { property: 'Delhi to Mumbai Express', type: 'bus', bookings: 38, revenue: 38000 },
        { property: 'Mountain Resort Shimla', type: 'accommodation', bookings: 18, revenue: 36000 },
        { property: 'Bangalore to Chennai Deluxe', type: 'bus', bookings: 32, revenue: 32000 }
      ];
      
      // Update with demo data first for better UX
      updateRevenueCharts(demoMonthlyRevenue, demoPropertyRevenue, demoTopProperties);
      updateTopPropertiesTable(demoTopProperties);
      
      // Fetch revenue data from API
      fetch('../php/api_admin.php?action=getRevenueData')
        .then(response => {
          console.log('Revenue API response:', response);
          if (!response.ok) {
            throw new Error(`HTTP error ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          console.log('Revenue data received:', data);
          if (data.success) {
            // Update revenue charts with real data if available
            if (data.monthlyRevenue && data.monthlyRevenue.length > 0 && 
                data.propertyRevenue && data.propertyRevenue.length > 0 && 
                data.topProperties && data.topProperties.length > 0) {
              updateRevenueCharts(data.monthlyRevenue, data.propertyRevenue, data.topProperties);
              updateTopPropertiesTable(data.topProperties);
            }
          } else {
            throw new Error(data.message || 'Failed to load revenue data');
          }
        })
        .catch(error => {
          console.error('Error loading revenue data:', error);
          // We already have demo data displayed, so just log the error
          // No need to show error messages to the user since they already see data
        });
    }
    
    // Function to update revenue charts
    function updateRevenueCharts(monthlyRevenue, propertyRevenue, topProperties) {
      console.log('Monthly Revenue:', monthlyRevenue);
      console.log('Property Revenue:', propertyRevenue);
      console.log('Top Properties:', topProperties);
      
      // Make the revenue section visible if it's not already
      const revenueSection = document.getElementById('revenue-section');
      // Store original display style
      const originalStyle = revenueSection.style.display;
      
      // Temporarily make visible if hidden to ensure canvas elements are accessible
      if (originalStyle === 'none') {
        revenueSection.style.display = 'block';
      }
      
      // Update revenue summary
      updateRevenueSummary(monthlyRevenue);
      
      // Clear any existing charts to prevent duplicates
      if (window.revenueGrowthChart) window.revenueGrowthChart.destroy();
      if (window.revenueSourceChart) window.revenueSourceChart.destroy();
      if (window.topPropertiesChart) window.topPropertiesChart.destroy();
      
      // Create all charts with error handling
      createRevenueGrowthChart(monthlyRevenue);
      createRevenueBySourceChart(propertyRevenue);
      createTopPropertiesChart(topProperties);
      
      // Restore original display style
      if (originalStyle === 'none') {
        revenueSection.style.display = originalStyle;
      }
    }
    
    // Function to update revenue summary cards
    function updateRevenueSummary(monthlyRevenue) {
      const revenueSummary = document.querySelector('#revenue-section .summary-cards');
      if (!revenueSummary) return;
      
      // Calculate total revenue
      const totalRevenue = monthlyRevenue.reduce((sum, month) => sum + month.revenue, 0);
      
      // Calculate average monthly revenue
      const avgMonthlyRevenue = totalRevenue / (monthlyRevenue.length || 1);
      
      // Find highest revenue month
      let highestMonth = { month: 'N/A', revenue: 0 };
      if (monthlyRevenue.length > 0) {
        highestMonth = monthlyRevenue.reduce((max, month) => 
          month.revenue > max.revenue ? month : max, monthlyRevenue[0]);
      }
      
      // Update summary cards
      revenueSummary.innerHTML = `
        <div class="summary-card">
          <div class="card-icon"><i class="fas fa-money-bill-wave"></i></div>
          <div class="card-content">
            <h3>Total Revenue</h3>
            <p class="value">₹${totalRevenue.toLocaleString()}</p>
          </div>
        </div>
        <div class="summary-card">
          <div class="card-icon"><i class="fas fa-chart-line"></i></div>
          <div class="card-content">
            <h3>Avg. Monthly</h3>
            <p class="value">₹${Math.round(avgMonthlyRevenue).toLocaleString()}</p>
          </div>
        </div>
        <div class="summary-card">
          <div class="card-icon"><i class="fas fa-calendar-check"></i></div>
          <div class="card-content">
            <h3>Best Month</h3>
            <p class="value">${highestMonth.month} (₹${highestMonth.revenue.toLocaleString()})</p>
          </div>
        </div>
      `;
    }
    
    // Function to create monthly revenue growth chart
    function createRevenueGrowthChart(monthlyRevenue) {
      try {
        const revenueGrowthElement = document.getElementById('revenueGrowthChart');
        if (!revenueGrowthElement || !monthlyRevenue || monthlyRevenue.length === 0) return;
        
        const ctx = revenueGrowthElement.getContext('2d');
        if (!ctx) return;
        
        // Extract months and revenue values
        const months = monthlyRevenue.map(item => item.month);
        const revenues = monthlyRevenue.map(item => item.revenue);
        
        window.revenueGrowthChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: months,
            datasets: [{
              label: 'Monthly Revenue',
              data: revenues,
              backgroundColor: 'rgba(52, 152, 219, 0.2)',
              borderColor: 'rgba(52, 152, 219, 1)',
              borderWidth: 2,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function(value) {
                    return '₹' + value;
                  }
                }
              }
            },
            plugins: {
              title: {
                display: true,
                text: 'Monthly Revenue Growth'
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    return '₹' + context.parsed.y.toLocaleString();
                  }
                }
              }
            }
          }
        });
      } catch (error) {
        console.error('Error creating revenue growth chart:', error);
      }
    }
    
    // Function to create revenue by source chart
    function createRevenueBySourceChart(propertyRevenue) {
      try {
        const revenueBySourceElement = document.getElementById('revenueBySourceChart');
        if (!revenueBySourceElement || !propertyRevenue || propertyRevenue.length === 0) return;
        
        const ctx = revenueBySourceElement.getContext('2d');
        if (!ctx) return;
        
        const propertyTypes = propertyRevenue.map(item => item.type);
        const propertyRevenues = propertyRevenue.map(item => item.revenue);
        const backgroundColors = [
          'rgba(52, 152, 219, 0.7)',  // Blue
          'rgba(46, 204, 113, 0.7)',  // Green
          'rgba(155, 89, 182, 0.7)',  // Purple
          'rgba(241, 196, 15, 0.7)',  // Yellow
          'rgba(231, 76, 60, 0.7)',   // Red
          'rgba(26, 188, 156, 0.7)'   // Teal
        ];
        
        window.revenueSourceChart = new Chart(ctx, {
          type: 'pie',
          data: {
            labels: propertyTypes,
            datasets: [{
              data: propertyRevenues,
              backgroundColor: backgroundColors,
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              title: {
                display: true,
                text: 'Revenue by Property Type'
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const label = context.label || '';
                    const value = context.parsed || 0;
                    const total = context.dataset.data.reduce((acc, val) => acc + val, 0);
                    const percentage = ((value / total) * 100).toFixed(1);
                    return `${label}: ₹${value.toLocaleString()} (${percentage}%)`;
                  }
                }
              }
            }
          }
        });
      } catch (error) {
        console.error('Error creating revenue by source chart:', error);
      }
    }
    
    // Function to create top properties chart
    function createTopPropertiesChart(topProperties) {
      try {
        const revenueChartElement = document.getElementById('revenueChart');
        if (!revenueChartElement || !topProperties || topProperties.length === 0) return;
        
        const revenueChartContext = revenueChartElement.getContext('2d');
        if (!revenueChartContext) return;
        const propertyNames = topProperties.map(item => item.property);
        const propertyRevenues = topProperties.map(item => item.revenue);
        const propertyBookings = topProperties.map(item => item.bookings);
        const propertyTypes = topProperties.map(item => item.type || 'accommodation');
        
        const barColors = topProperties.map(item => 
          item.type === 'bus' ? 'rgba(231, 76, 60, 0.7)' : 'rgba(52, 152, 219, 0.7)'
        );
        
        window.topPropertiesChart = new Chart(revenueChartContext, {
          type: 'bar',
          data: {
            labels: propertyNames,
            datasets: [{
              label: 'Revenue',
              data: propertyRevenues,
              backgroundColor: barColors,
              borderColor: barColors.map(color => color.replace('0.7', '1')),
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function(value) {
                    return '₹' + value;
                  }
                }
              }
            },
            plugins: {
              title: {
                display: true,
                text: 'Top Properties by Revenue'
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const dataIndex = context.dataIndex;
                    const type = propertyTypes[dataIndex];
                    const bookings = propertyBookings[dataIndex];
                    return [
                      `Type: ${type}`,
                      `Revenue: ₹${context.parsed.y.toLocaleString()}`,
                      `Bookings: ${bookings}`
                    ];
                  }
                }
              }
            }
          }
        });
      } catch (error) {
        console.error('Error creating top properties chart:', error);
      }
    }
    
    // Function to create users chart (placeholder with demo data)
    function createUsersChart() {
      try {
        const usersChartElement = document.getElementById('usersChart');
        if (!usersChartElement) return;
        
        const usersChartCtx = usersChartElement.getContext('2d');
        if (!usersChartCtx) return;
        // Generate some random data for user growth
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
        const userData = [12, 19, 25, 32, 45, 55];
        
        window.usersGrowthChart = new Chart(usersChartCtx, {
            type: 'line',
            data: {
              labels: months,
              datasets: [{
                label: 'New Users',
                data: userData,
                backgroundColor: 'rgba(46, 204, 113, 0.2)',
                borderColor: 'rgba(46, 204, 113, 1)',
                borderWidth: 2,
                tension: 0.4
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                y: {
                  beginAtZero: true
                }
              },
              plugins: {
                title: {
                  display: true,
                  text: 'User Growth'
                }
              }
            }
          });
      } catch (error) {
        console.error('Error creating users chart:', error);
      }
      // Update top properties table
      const topPropertiesTable = document.querySelector('#revenue-section .data-table table tbody');
      if (topPropertiesTable && topProperties && topProperties.length > 0) {
        let tableContent = '';
        
        topProperties.forEach(property => {
          tableContent += `
            <tr>
              <td>${property.property}</td>
              <td>${property.bookings}</td>
              <td>₹${property.revenue.toFixed(2)}</td>
            </tr>
          `;
        });
        
        topPropertiesTable.innerHTML = tableContent;
      }
    }
    
    // Function to update top properties table
    function updateTopPropertiesTable(topProperties) {
      console.log('Updating top properties table:', topProperties);
      
      const topPropertiesTable = document.querySelector('#top-properties-table tbody');
      if (topPropertiesTable && topProperties && topProperties.length > 0) {
        let tableContent = '';
        
        topProperties.forEach(property => {
          const badgeClass = property.type === 'bus' ? 'badge-bus' : 'badge-accommodation';
          tableContent += `
            <tr>
              <td>${property.property}</td>
              <td><span class="badge ${badgeClass}">${property.type === 'bus' ? 'Bus' : 'Accommodation'}</span></td>
              <td>${property.bookings}</td>
              <td>₹${property.revenue.toLocaleString()}</td>
            </tr>
          `;
        });
        
        // Fill remaining rows if less than 5 properties
        if (topProperties.length < 5) {
          for (let i = topProperties.length; i < 5; i++) {
            tableContent += `
              <tr>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
              </tr>
            `;
          }
        }
        
        topPropertiesTable.innerHTML = tableContent;
      }
    }
    
    // Function to load transactions data
    function loadTransactionsData() {
      // Show loading indicator
      document.querySelector('#transactions-section .data-table tbody').innerHTML = 
        '<tr><td colspan="8" class="text-center"><i class="fas fa-spinner fa-spin"></i> Loading transactions...</td></tr>';
      
      // Fetch transactions from API
      fetch('../php/api_admin.php?action=getTransactions')
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          if (data.success) {
            updateTransactionsTable(data.transactions);
          } else {
            throw new Error(data.message || 'Failed to load transactions');
          }
        })
        .catch(error => {
          console.error('Error loading transactions:', error);
          document.querySelector('#transactions-section .data-table tbody').innerHTML = 
            `<tr><td colspan="8" class="text-center"><i class="fas fa-exclamation-circle"></i> ${error.message}</td></tr>`;
        });
    }
    
    // Function to update transactions table
    function updateTransactionsTable(transactions) {
      const tbody = document.querySelector('#transactions-section .data-table tbody');
      if (!tbody) return;
      
      if (transactions.length === 0) {
        tbody.innerHTML = '<tr><td colspan="8" class="text-center">No transactions found</td></tr>';
        return;
      }
      
      let html = '';
      transactions.forEach(transaction => {
        const date = new Date(transaction.created_at).toLocaleString();
        const statusClass = transaction.status === 'completed' ? 'status-completed' : 
                           transaction.status === 'pending' ? 'status-pending' : 'status-cancelled';
        
        html += `
          <tr>
            <td>#TXN${transaction.transaction_id}</td>
            <td>#BK${transaction.booking_id}</td>
            <td>${transaction.username}</td>
            <td>${date}</td>
            <td>₹${parseFloat(transaction.total_amount).toLocaleString()}</td>
            <td>Credit Card</td>
            <td><span class="status ${statusClass}">${transaction.status}</span></td>
            <td>
              <button class="action-btn view-btn" data-id="${transaction.booking_id}" onclick="viewBooking(${transaction.booking_id})">
                <i class="fas fa-eye"></i>
              </button>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }
    
    // Function to handle action buttons
    document.querySelectorAll('.action-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const action = this.innerHTML.includes('Edit') ? 'edit' : 
                      this.innerHTML.includes('Delete') ? 'delete' : 'view';
        const id = this.getAttribute('data-id');
        if (id) {
          if (action === 'edit') {
            editUser(id);
          } else if (action === 'delete') {
            deleteUser(id);
          } else {
            viewUser(id);
          }
        } else {
          alert(`Action: ${action}`);
        }
      });
    });
  </script>
</body>
</html>